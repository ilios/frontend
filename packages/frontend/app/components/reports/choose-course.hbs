<div class="reports-choose-course">
  <ul class="schools">
    {{#each this.sortedSchools as |s|}}
      <li class="school">
        <button
          type="button"
          aria-expanded={{if (eq s.id this.expandedSchool.id) "true" "false"}}
          {{on "click" (fn this.toggleSchool s.id)}}
        >
          {{s.title}}
          <FaIcon @icon={{if (eq s.id this.expandedSchool.id) "caret-down" "caret-right"}} />
        </button>
        {{#if (eq s.id this.expandedSchool.id)}}
          {{#each this.visibleExapndedSchoolYears as |y|}}
            <ul class="year {{if (eq y.year this.expandedYear) 'expanded' 'collapsed'}}">
              <li>
                <button
                  type="button"
                  aria-expanded={{if (eq y.year this.expandedYear) "true" "false"}}
                  {{on "click" (fn this.toggleYear y.year)}}
                >
                  {{y.year}}
                  <FaIcon @icon={{if (eq y.year this.expandedYear) "caret-down" "caret-right"}} />
                </button>
              </li>
              {{#if (eq y.year this.expandedYear)}}
                <ul class="courses">
                  {{#each (sort-by "title" y.courses) as |c|}}
                    <li>
                      <label>
                        <input
                          type="checkbox"
                          checked={{includes c.id @selectedCourseIds}}
                          {{on
                            "click"
                            (fn (if (includes c.id @selectedCourseIds) @remove @add) c.id)
                          }}
                        />
                        {{c.title}}
                        {{#if c.externalId}}
                          ({{c.externalId}})
                        {{/if}}
                      </label>
                    </li>
                  {{/each}}
                </ul>
              {{/if}}
            </ul>
          {{/each}}
        {{/if}}
      </li>
    {{/each}}
  </ul>
</div>