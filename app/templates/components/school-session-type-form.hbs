<div class='form'>
  <div class='item'>
    <label>{{t 'general.title'}}:</label>
    {{#if canEditTitle}}
      {{one-way-input
        value=title
        update=(action (mut title))
        onenter=(perform saveSessionType)
        onescape=(action close)
        focusOut=(action 'addErrorDisplayFor' 'title')
      }}
      {{#if (and (v-get this 'title' 'isInvalid') (is-in showErrorsFor 'title'))}}
        <span class="message error">{{v-get this 'title' 'message'}}</span>
      {{/if}}
    {{else}}
      <span class='value'>{{title}}</span>
    {{/if}}
  </div>

  <div class='item'>
    <label>{{t 'general.aamcMethod'}}</label>
      {{#if (is-fulfilled aamcMethods)}}
        <select onchange={{action (mut selectedAamcMethodId) value="target.value"}}>
          {{#each (sort-by 'description' (await aamcMethods)) as |aamcMethod|}}
            <option value="{{aamcMethod.id}}" selected={{eq aamcMethod.id (get (await selectedAamcMethod) 'id')}}>
              {{aamcMethod.description}}
            </option>
          {{/each}}
        </select>
      {{else}}
        {{fa-icon 'spinner' spin=true}}
      {{/if}}
  </div>
  
  <div class='item calendar-color'>
    <label>{{t 'general.color'}}:</label>
    {{#if canEditCalendarColor}}
      {{one-way-input
        type='color'
        value=calendarColor
        update=(action (mut calendarColor))
        focusOut=(action 'addErrorDisplayFor' 'calendarColor')
      }}
      {{#if (and (v-get this 'calendarColor' 'isInvalid') (is-in showErrorsFor 'calendarColor'))}}
        <span class="message error">{{v-get this 'calendarColor' 'message'}}</span>
      {{/if}}
    {{else}}
      <span class='value'>
        <span class='box' style={{{concat 'background-color: ' calendarColor}}}></span>
        {{calendarColor}}
      </span>
    {{/if}}
  </div>

  <div class='item'>
    <label>{{t 'general.assessment'}}:</label>
    {{#if canEditAssessment}}
      {{toggle-yesno yes=assessment toggle=(action (mut assessment))}}
    {{else}}
      <span class='value {{if assessment "yes" "no"}}'>
        {{#if assessment}}
          {{t 'general.yes'}}
        {{else}}
          {{t 'general.no'}}
        {{/if}}
      </span>
    {{/if}}
  </div>

  {{#if assessment}}
    <div class='item'>
      <label>{{t 'general.assessmentOption'}}:</label>
      {{#if canEditAssessmentOption}}
        <select onchange={{action (mut assessmentOptionId) value="target.value"}}>
          {{#each (sort-by 'name' assessmentOptions) as |option|}}
            <option value={{option.id}} selected={{eq option.id assessmentOption.id}}>
              {{option.name}}
            </option>
          {{/each}}
        </select>
      {{else}}
        <span class='value'>{{assessmentOption.name}}</span>
      {{/if}}
    </div>
  {{/if}}


  <div class='buttons'>
    <button class='done text' {{action (perform saveSessionType)}} disabled={{saveSessionType.isRunning}}>
      {{#if saveSessionType.isRunning}}
        {{fa-icon 'spinner' spin=true}}
      {{else}}
        {{t 'general.done'}}
      {{/if}}
    </button>
    <button class='cancel text' {{action close}}>{{t 'general.cancel'}}</button>
  </div>
</div>
